package edu.gmu.cs.infs614.webdealer.model;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import javafx.beans.property.SimpleIntegerProperty;
import javafx.beans.property.SimpleStringProperty;

/* Customer model
CREATE TABLE Customer( 
customer_ID INTEGER, 
first_name VARCHAR2(30), 
last_name VARCHAR2(30), 
age INTEGER, 
email_address VARCHAR2(100), 
gender VARCHAR2(1), 
PRIMARY KEY (customer_ID)
);
INSERT INTO Customer VALUES (seq_customer.nextval,'John','Doe','30','jdoe@gmu.edu','m');
*/

// Immutable tuple
public class Customer {

	// private final SimpleIntegerProperty cID; not sure if we need this ye
	private final SimpleStringProperty cFirstName;
	private final SimpleStringProperty cLastName;
	private final SimpleIntegerProperty cAge;
	private final SimpleStringProperty cEmailAddress;
	private final SimpleStringProperty cGender;
	private static Connection conn = null;
	
	// Think about how we can model the key that's generated by Oracle
	public Customer(Connection conn, String cFirstName, String cLastName, Integer cAge, String cEmailAddress, String cGender) {
		this.cFirstName = new SimpleStringProperty(cFirstName);
		this.cLastName = new SimpleStringProperty(cFirstName);
		this.cAge = new SimpleIntegerProperty(cAge);
		this.cEmailAddress = new SimpleStringProperty(cEmailAddress);
		this.cGender = new SimpleStringProperty(cGender);
		Customer.conn = conn;
	}

	// CRUD
	public int create(Connection conn, 
			String cFirstName, String cLastName, 
			Integer cAge, String cEmailAddress, String cGender) {
		
		String sql = "INSERT INTO Customer VALUES (" +
						"seq_customer.nextval," +
						cFirstName + "," +
						cLastName + "," + 
						cAge + "," +
						cEmailAddress + "," +
						cGender + ")";
		
		int rowCount = 0;
		
		try {
			PreparedStatement pstmt = conn.prepareStatement(sql);
			rowCount = pstmt.executeUpdate();
			pstmt.closeOnCompletion(); // auto commit was set in the abstract
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return rowCount;
	}
	
	
	// getters 
	
	public SimpleStringProperty getcFirstName() {
		return cFirstName;
	}

	public SimpleStringProperty getcLastName() {
		return cLastName;
	}

	public SimpleIntegerProperty getcAge() {
		return cAge;
	}

	public SimpleStringProperty getcEmailAddress() {
		return cEmailAddress;
	}

	public SimpleStringProperty getcGender() {
		return cGender;
	}

	
	
	
}
